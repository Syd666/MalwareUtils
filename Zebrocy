# -*- coding: utf-8 -*-
"""
Created on Mon Dec 17 20:45:13 2018

@author: Moi

Checks if file has Zebrocy Tform1 class
"""

import pefile
path = raw_input("where is the file?")
pe = pefile.PE(path)
tform1 = ""
offset = 0x0
size = 0x0

for rsrc in pe.DIRECTORY_ENTRY_RESOURCE.entries:
    for entry in rsrc.directory.entries:
        if entry.name is not None:
            print(entry.name)
            if entry.name.__str__()  == "TFORM1":
                offset = entry.directory.entries[0].data.struct.OffsetToData
                size = entry.directroy.entries[0].data.struct.Size
form1_struct = pe.get_memory_image()[offset:offset+size]
print(form1_struct)
                
